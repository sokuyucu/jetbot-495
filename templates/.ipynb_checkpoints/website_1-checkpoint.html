<!DOCTYPE html>
<html lang="en">
<head>    
    <script src="{{url_for('static', filename='website_1.js')}}"></script>
    <!--    
    <link rel="stylesheet" href="https://pyscript.net/alpha/pyscript.css" />
    <script defer src="https://pyscript.net/alpha/pyscript.js"></script>
    -->
</head>

<body>
    
    <section>
      <h1>Group 5 Jetbot Interface</h1>
      <p id=status_1>IDLE.</p>
    </section>
    
    <!-- CAMERA FEED   -->
    <img src="{{ url_for('video_feed') }}">
    
    <!-- BUTTONS   -->
    <h1>JETBOT CONTROLS</h1>

    <button type="button" onclick="StatusUpdate()">INITIATE</button>

    
<!--    
    <p>Random number generated by python code is... 
      <span id='labelTag'> </span> 
    </p>
    
    <py-script>
      import random
     
      def generateRandomNumber():
        return random.randint(0,9) 

      pyscript.write('labelTag',generateRandomNumber())
    </py-script>
    
    <h1>Python Values: <span id="values"></span></h1>
    <script>
        function fetchRuntimeValues() {
            fetch('/get_runtime_values')
                .then(response => response.json())
                .then(data => {
                    document.getElementById('values').textContent = data.values;
                })
                .catch(error => console.error('Error:', error));
        }

        // Fetch the initial value immediately
        fetchRuntimeValues();

        // Fetch the updated value every 1 second
        setInterval(fetchRuntimeValues, 1000);
    </script>

    
    <div class="data">
    <p id="output"></p>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <script>
        function update(){
            $.get("/update", function(data){
                $("#output").html(data)
            });
        }
        update()
        var intervalId = setInterval(function() {
            update()
        }, 10000);

    </script>
  
    
<h1>Python Values: <span id="values"></span></h1>
    <script>
        function fetchRuntimeValues() {
            // Create a new XMLHttpRequest object
            const xhr = new XMLHttpRequest();

            // Set up the callback function for when the request is completed
            xhr.onreadystatechange = function () {
                if (xhr.readyState === XMLHttpRequest.DONE) {
                    if (xhr.status === 200) {
                        const data = JSON.parse(xhr.responseText);
                        document.getElementById('values').textContent = data.value;
                    } else {
                        console.error('Error:', xhr.status, xhr.statusText);
                    }
                }
            };

            // Open a GET request to the /get_runtime_value endpoint
            xhr.open('GET', '/get_runtime_values', true);

            // Send the request
            xhr.send();
        }

        // Fetch the initial value immediately
        fetchRuntimeValues();

        // Fetch the updated value every 1 second
        setInterval(fetchRuntimeValues, 1000);
    </script>
-->     
    <div id="data-container">
        <!-- The received data will be displayed here -->
    </div>

    <script>
    function fetchData() {
        fetch('/get_data') // Replace this URL with the appropriate endpoint on your server
            .then(response => response.json())
            .then(data => {
                // Process the received data
                const container = document.getElementById('data-container');
                container.innerHTML = `
                    <p>${data.message}</p>
                    <p>Value: <span id="dynamic-value">${data.value}</span></p>
                `;
            })
            .catch(error => {
                console.error('Error fetching data:', error);
            });
    }

    // Fetch data initially
    fetchData();

    // Fetch data periodically every 5 seconds
    setInterval(fetchData, 5000);
    </script>
    
</body>

</html>